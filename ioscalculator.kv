#:import Factory kivy.factory.Factory
#:import os os

<SettingsWindow@Popup>:

    display: 'dispopup'
    name: "Settings"
    size_hint: None, None
    size: (660, 960) #######################
    auto_dismiss: False
    title: "Настройки"
    title_align: 'center' # Расположение по центру
    title_color: ('#FF9500') # Цвет Заголовка
    separator_color: ('#FF9500') # Цвет Линии
    background_color: ('#505050')

    BoxLayout:

        spacing: 10
        padding: 10
        orientation: "vertical"

        Label:
            text: 'Кеш ошибок'
            size_hint: None, None
            size: 75, 75
            #pos: 10, 10
            pos_hint: {"center_y": .85, "center_x": .05}


        RemoveLogOrangeRoundedButton:
            text: 'Удалить'
            font_size: 12
            on_release: root.remove_log()
            size: 75, 35
            pos: 10, 10
            size_hint: None, None
            pos_hint: {"center_y": 100, "center_x": .037}

        Label:
            text: 'Размер Шрифта ответа:'
            font_size: 24
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            halign: ('center')
            size: 75, 35
            size_hint: None, None
            pos_hint: {"center_y": .999, "center_x": .19}

        Slider:
            id: FontSizeSlider
            min: 48
            max: 512
            step: 2
            value: 128
            orientation: 'horizontal'
            value_track: True
            value_track_color: ('#FF9500')

        TextInput:

            id: SetFont
            text: str(FontSizeSlider.value)
            font_size: 64
            background_color: (0,0,0,0)
            foreground_color: [255, 255, 255] # Белый
            multiline: False
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #color: ('#1C1C1C')
            cursor_color: [255, 255, 255, .3]
            selection_color: [255, 255, 255, .3]
            halign: ('center')
            input_filter: 'int'

        Label:
            text: 'Размер Шрифта кнопок:'
            font_size: 24
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            halign: ('center')
            size: 75, 35
            size_hint: None, None
            pos_hint: {"center_y": .999, "center_x": .19}

        Slider:
            id: FontSizeSliderButton
            min: 48
            max: 512
            step: 2
            value: 72
            orientation: 'horizontal'
            value_track: True
            value_track_color: ('#FF9500')

        TextInput:

            id: SetFontButton
            text: str(FontSizeSliderButton.value)
            font_size: 64
            background_color: (0,0,0,0)
            foreground_color: [255, 255, 255] # Белый
            multiline: False
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #color: ('#1C1C1C')
            cursor_color: [255, 255, 255, .3]
            selection_color: [255, 255, 255, .3]
            halign: ('center')
            input_filter: 'int'

        LightGrayRoundedButton:
            text: "Готово"
            font_size: 32
            on_release: root.SetFontSize()


#:import utils kivy.utils

<LightSettingsRoundedButton@Button>
    font_size: 72
    background_color: (0,0,0,0)
    background_normal: ''
    color: ('#1C1C1C')
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#D4D4D2')

        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [15]

<GrayRoundedButton@Button>
    font_size: 72
    background_color: (0,0,0,0)
    background_normal: ''
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#333333')

        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [100]

<RemoveLogOrangeRoundedButton@Button>
    font_size: 72
    background_color: (0,0,0,0)
    background_normal: ''
    color: (1, 1, 1, 1)
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#FF9500')

        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [15]


<OrangeRoundedButton@Button>
    font_size: 72
    background_color: (0,0,0,0)
    background_normal: ''
    color: (1, 1, 1, 1)
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#FF9500')

        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [100]

<LightGrayRoundedButton@Button>
    font_size: 72
    background_color: (0,0,0,0)
    background_normal: ''
    color: ('#1C1C1C')
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#D4D4D2')

        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [100]
            #D4D4D2



<CalcGridLayout>:

    name: 'MainCalc'

    id: calculator
    display:entry
    rows: 10
    padding: 0
    spacing: 0

    BoxLayout:

        spacing: 0
        padding: 0

        LightSettingsRoundedButton:
            text: "Настройки"
            on_press: Factory.SettingsWindow().open()
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            font_size: 12
            #background_color: ('#505050')
            size: 75, 35
            size_hint: None, None
            pos_hint: {"center_y": .85, "center_x": .85}

        TextInput:

            input_filter: 'int'
            readonly: False # Запретить ввод
            id: entry
            font_size: int(root.setline)
            text: ''
            background_color: [0, 0, 0] # Черный
            foreground_color: [255, 255, 255] # Белый
            multiline: False
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            color: ('#1C1C1C')
            cursor_color: [255, 255, 255, .3]
            selection_color: [255, 255, 255, .3]
            halign: ('right') #################################left#####################################################

    BoxLayout:

        spacing: 10
        padding: 10

        LightGrayRoundedButton:
            font_size: int(root.setlineb)
            text: "C"
            on_press: root.Clear()
            #background_color: ('#D4D4D2')
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

        LightGrayRoundedButton:
            font_size: int(root.setlineb)
            text: "+/-"
            on_press: root.positive_number()
            #background_color: ('#D4D4D2')
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

        LightGrayRoundedButton:
            font_size: int(root.setlineb)
            text: "%"
            on_press:entry.text += self.text
            #background_color: ('#D4D4D2')
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

        OrangeRoundedButton:
            font_size: int(root.setlineb)
            on_press:entry.text += "/"
            text:"÷"
            background_normal: ('')
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

    BoxLayout:
        spacing: 10
        padding: 10

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "7"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            background_normal: ('')
            #background_color: ('#505050')

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "8"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "9"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        OrangeRoundedButton:
            font_size: int(root.setlineb)
            text:"×"
            on_press:entry.text += '*'
            background_normal: ('')
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

    BoxLayout:

        spacing: 10
        padding: 10

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "4"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "5"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "6"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        OrangeRoundedButton:
            font_size: int(root.setlineb)
            text: "-"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

    BoxLayout:

        spacing: 10
        padding: 10

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "1"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "2"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "3"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')

        OrangeRoundedButton:
            font_size: int(root.setlineb)
            text: "+"
            on_press:entry.text += self.text
            font_name: ('fonts/SFUIDisplay-Regular.ttf')

    BoxLayout:
        spacing: 10
        padding: 10

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: "0"
            on_press: entry.text += '0'
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#505050')
            color: (1, 1, 1, 1)
            size_hint: (2, .99)

        GrayRoundedButton:
            font_size: int(root.setlineb)
            text: ","
            on_press: entry.text += ('.')
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            pos_hint: {'center_x': 0.8}
            size_hint: (1, 1)
            #background_normal: ''
            #background_color: ('#FF9500')

        OrangeRoundedButton:
            font_size: int(root.setlineb)
            text: "="
            on_press: calculator.Calculate(entry.text)
            font_name: ('fonts/SFUIDisplay-Regular.ttf')
            #background_color: ('#FF9500')